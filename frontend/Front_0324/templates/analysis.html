{% extends "base.html" %}

{% block title %}불량 분석{% endblock %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/analysis.css') }}">
<script src="{{ url_for('static', filename='js/analysis.js') }}" defer></script>

{% block content %}
<head>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet"/>
    <link href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css" rel="stylesheet"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.5.0/echarts.min.js"></script>
    <script src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script>
    <script src="https://ai-public.creatie.ai/gen_page/tailwind-config.min.js" data-color="#000000" data-border-radius="small"></script>
    <style>
        /* 페이지 기본 레이아웃 */
main.main-content {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem 1.5rem;
}

/* 박스 공통 스타일 */
.box-container {
  background-color: white;
  border: 1px solid #e5e7eb;
  border-radius: 0.5rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  padding: 1.5rem;
}

/* 섹션 제목 */
.section-title {
  font-size: 1.125rem;
  font-weight: 600;
  color: #1f2937;
}

/* 셀렉트 박스 */
.select-box {
  padding: 0.5rem 1rem;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  background-color: #f9fafb;
  font-size: 0.875rem;
  color: #111827;
  transition: all 0.2s ease;
}
.select-box:hover {
  border-color: #60a5fa;
  box-shadow: 0 0 0 3px rgba(96,165,250,0.3);
}

/* 차트 영역 높이 */
.chart-area {
  height: 400px;
}

/* 테이블 */
.analysis-table {
  width: 100%;
  font-size: 0.875rem;
  border-collapse: collapse;
}
.analysis-table th {
  background-color: #f9fafb;
  color: #6b7280;
  font-weight: 500;
  text-align: left;
  padding: 0.75rem 1rem;
}
.analysis-table td {
  padding: 0.75rem 1rem;
  color: #374151;
}
.analysis-table tr:hover {
  background-color: #f3f4f6;
}
.analysis-table td span {
  padding: 0.25rem 0.5rem;
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 500;
}

/* 상태 뱃지 */
.badge-red {
  background-color: #fee2e2;
  color: #b91c1c;
}
.badge-yellow {
  background-color: #fef9c3;
  color: #92400e;
}

/* 페이지네이션 */
.pagination {
  display: flex;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 2rem;
}
.pagination button {
  padding: 0.5rem 0.75rem;
  font-size: 0.875rem;
  border: 1px solid #d1d5db;
  border-radius: 0.375rem;
  background-color: white;
}
.pagination button.active {
  background-color: #2563eb;
  color: white;
  border-color: #2563eb;
}

    </style>
</head>

<main class="main-content">
    <!-- 차트 컨테이너 -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <div class="bg-white rounded-lg shadow p-6">
            <div class="chart-header">
                <h3>생산라인별 불량률</h3>
                <select>
                    <option>일간</option>
                    <option>주간</option>
                    <option>월간</option>
                </select>
            </div>
            <div id="lineChart" style="height: 400px;"></div>
        </div>
        <div class="bg-white rounded-lg shadow p-6">
            <div class="chart-header">
                <h3>불량률 추이</h3>
                <select>
                    <option>일간</option>
                    <option>주간</option>
                    <option>월간</option>
                </select>
            </div>
            <div id="barChart" style="height: 400px;"></div>
        </div>
    </div>

    <!-- 불량 로그 -->
    <div class="bg-white rounded-lg shadow p-6">
        <div class="flex items-center justify-between mb-6">
            <h3 class="text-lg font-medium text-gray-900">불량 로그</h3>
            <div class="flex items-center space-x-4">
                <div class="text-sm text-gray-700">총 <span class="font-medium">97</span>개 항목 중 <span class="font-medium">1-10</span></div>
            </div>
        </div>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead>
                    <tr>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">날짜</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">불량 번호</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">생산라인</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">불량 점수</th>
                        <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase">불량 정도</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-15</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1024</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 A</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">92점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">심각</span></td>
                    </tr>
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-15</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1023</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 B</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">88점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">심각</span></td>
                    </tr>
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-14</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1022</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 C</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">75점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">주의</span></td>
                    </tr>
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-14</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1021</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 A</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">82점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">심각</span></td>
                    </tr>
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-13</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1020</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 B</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">68점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">주의</span></td>
                    </tr>
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-13</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1019</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 C</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">85점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">심각</span></td>
                    </tr>
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-12</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1018</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 A</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">72점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">주의</span></td>
                    </tr>
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-12</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1017</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 B</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">78점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">주의</span></td>
                    </tr>
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-11</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1016</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 C</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">90점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">심각</span></td>
                    </tr>
                    <tr class="hover:bg-gray-50 cursor-pointer">
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2024-02-11</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">#1015</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">라인 A</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">83점</td>
                        <td class="px-6 py-4 whitespace-nowrap"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">심각</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="mt-4 flex items-center justify-between">
            <div class="flex space-x-2 justify-center w-full mt-8">
                <button class="px-3 py-1 border rounded text-sm">이전</button>
                <button class="px-3 py-1 bg-custom text-white rounded text-sm">1</button>
                <button class="px-3 py-1 border rounded text-sm">다음</button>
            </div>
        </div>
    </div>
</main>


<script>
    // 생산라인별 불량률 차트
const lineChart = echarts.init(document.getElementById('lineChart'));
lineChart.setOption({
  tooltip: { trigger: 'axis' },
  legend: { data: ['불량률'] },
  xAxis: { type: 'category', data: ['라인 A', '라인 B', '라인 C'] },
  yAxis: { type: 'value', axisLabel: { formatter: '{value}%' } },
  series: [{
    name: '불량률',
    type: 'bar',
    data: [2.5, 1.9, 2.2],
    itemStyle: { color: '#e74c3c', borderRadius: [10, 10, 0, 0] }
  }]
});

// 불량률 추이 차트
const barChart = echarts.init(document.getElementById('barChart'));
barChart.setOption({
  tooltip: { trigger: 'axis' },
  xAxis: { type: 'category', data: ['2/9', '2/10', '2/11', '2/12', '2/13', '2/14', '2/15'] },
  yAxis: { type: 'value', axisLabel: { formatter: '{value}%' } },
  series: [{
    data: [2.1, 2.4, 1.8, 2.8, 2.3, 2.9, 2.5],
    type: 'bar',
    barWidth: '40%',
    itemStyle: { color: '#3498db', borderRadius: [10, 10, 0, 0] }
  }]
});

// 창 크기 조절 시 차트 리사이즈
window.addEventListener('resize', () => {
  lineChart.resize();
  barChart.resize();
});

</script>
{% endblock %}